《レッスンＳＥＰＴ ☆ 遊睡のスプライト短期講座》

　ども、ＳＥＰＴ作者の夢神楽 遊睡です。
　ここでは、スプライトの概念がよく解らないという方の為に、ＳＥＰＴを例にしたスプライト使用法を伝授します。といっても、基本的な内容しか書きませんし、最低BASICの基礎知識は覚えていないと、多少難しいかもしれません。


■スプライトって何？
　スプライトというのは、ｸﾞﾗﾌｨｯｸ面(背景)の上に、セル画みたいにｽﾌﾟﾗｲﾄ面が３２枚乗っかっていて、ｸﾞﾗﾌｨｯｸ面とは無関係に表示することができます。そして、座標を指定するだけでハード的に表示されますから、表示スピードも早いんです。
　ＭＳＸにはｽﾌﾟﾗｲﾄﾓｰﾄﾞと呼ばれる物が２種類あり、それぞれの特徴としては、
　ｽﾌﾟﾗｲﾄﾓｰﾄﾞ1････SCREEN1〜3。単色。横最大４ｽﾌﾟﾗｲﾄまで表示
　ｽﾌﾟﾗｲﾄﾓｰﾄﾞ2････SCREEN4〜8。ライン毎に色指定、重ね合わせＯＫ。
　　　　　　　　 横最大８ｽﾌﾟﾗｲﾄまで表示
　機能としては後から追加されたｽﾌﾟﾗｲﾄﾓｰﾄﾞ2の方が上です。
（それでも今のゲーム機からすれば、かなり貧弱なものになってしまっていますが･･･）
　同じＹ座標にﾓｰﾄﾞ毎の横最大数を越えてｽﾌﾟﾗｲﾄを表示すると、ﾊﾟﾀｰﾝ番号の多いものから消えていきます。

■スプライトの構成
　ｽﾌﾟﾗｲﾄの構成は次の通りです。

　ｽﾌﾟﾗｲﾄﾓｰﾄﾞ1
　　ｽﾌﾟﾗｲﾄｼﾞｪﾈﾚｰﾀﾃｰﾌﾞﾙ････ｽﾌﾟﾗｲﾄの形を定義するﾃｰﾌﾞﾙです。
　　　　　　　　　　　　　8x8ﾄﾞｯﾄで256ﾊﾟﾀｰﾝ。16x16ﾄﾞｯﾄで64ﾊﾟﾀｰﾝ定義可能です。
　　　　　　　　　　　　　SEPTを使えば、面倒な計算を必要とせず、SELECTOR部の
　　　　　　　　　　　　　DAT形式で出力されます。　
　　ｽﾌﾟﾗｲﾄｱﾄﾘﾋﾞｭｰﾄﾃｰﾌﾞﾙ･･･実際に画面に表示するｽﾌﾟﾗｲﾄと場所、そして色(単色)を
　　　　　　　　　　　　　指定するﾃｰﾌﾞﾙです。
　　　　　　　　　　　　　最大32枚まで表示できます。

　ｽﾌﾟﾗｲﾄﾓｰﾄﾞ2
　　ｽﾌﾟﾗｲﾄｼﾞｪﾈﾚｰﾀﾃｰﾌﾞﾙ････ｽﾌﾟﾗｲﾄﾓｰﾄﾞ1と同じです。
　　ｽﾌﾟﾗｲﾄｱﾄﾘﾋﾞｭｰﾄﾃｰﾌﾞﾙ･･･色指定はｽﾌﾟﾗｲﾄｶﾗｰﾃｰﾌﾞﾙに移り、実際画面に表示するｽﾌﾟﾗ
　　　　　　　　　　　　　ｲﾄ番号と座標だけをこのﾃｰﾌﾞﾙで指定します。
　　　　　　　　　　　　　ﾓｰﾄﾞ1同様、最大32枚まで表示できます。
　　ｽﾌﾟﾗｲﾄｶﾗｰﾃｰﾌﾞﾙ････････１つのｽﾌﾟﾗｲﾄに1ﾗｲﾝ毎に色を指定することができます。
　　　　　　　　　　　　　またOR指定(重ね合わせ)すると、OR色を使えるようになり
　　　　　　　　　　　　　衝突判定がなくなります。
　　　　　　　　　　　　　（ここではOR(論理和)の説明はしません。SEPTのEDITOER
　　　　　　　　　　　　　　部の｢1+2｣とかの色のことだと思って下さい）
　　ｽﾌﾟﾗｲﾄｱﾄﾘﾋﾞｭｰﾄﾃｰﾌﾞﾙ･･･色指定はｽﾌﾟﾗｲﾄｶﾗｰﾃｰﾌﾞﾙに移り、実際画面に表示するｽﾌﾟﾗ
　　　　　　　　　　　　　ｲﾄ番号と座標だけをこのﾃｰﾌﾞﾙで指定します。
　　　　　　　　　　　　　ﾓｰﾄﾞ1同様、最大32枚まで表示できます。

　ここで注意しなければならないことは、ｽﾌﾟﾗｲﾄｶﾗｰﾃｰﾌﾞﾙはｽﾌﾟﾗｲﾄｼﾞｪﾈﾚｰﾀﾃｰﾌﾞﾙと１対１なのではなく、ｽﾌﾟﾗｲﾄｱﾄﾘﾋﾞｭｰﾄﾃｰﾌﾞﾙと１対１の対応をしていることです。したがって、キャラクタと色が対応しているのではなく、表示するｽﾌﾟﾗｲﾄ面に対して色が指定されている訳です。よく間違えますので覚えておいてください。


■実際の使い方
　ここでは、BASIC上で、SCREEN5(ｽﾌﾟﾗｲﾄﾓｰﾄﾞ2)に16x16ﾄﾞｯﾄのｽﾌﾟﾗｲﾄを１枚表示することを仮定して説明します。

　まず、SCREEN文で、
　　SCREEN 5,2
　として、SCREEN5の16x16ﾄﾞｯﾄｻｲｽﾞを指定します。
（SCREEN文の第2ﾊﾟﾗﾒｰﾀは 0･･8x8標準 1･･8x8拡大 2･･16x16標準 3･･･16x16拡大）

　次に、ｽﾌﾟﾗｲﾄｼﾞｪﾈﾚｰﾀﾃｰﾌﾞﾙに１つのｽﾌﾟﾗｲﾄを定義します。
　　D$="":READ A$
　　FOR J=0 TO 31:D$=D$+CHR$(VAL("&H"+MID$(A$,J*2+1,2))):NEXT
　　SPRITE$(0)=D$
　SEPTのDAT形式で出力されたDATA文なら、これでＯＫです。
　分かんなくても大丈夫。(^^;)　このままでもｽﾌﾟﾗｲﾄは定義されています。
　SPRITE$(ﾊﾟﾀｰﾝ番号)文がｽﾌﾟﾗｲﾄｼﾞｪﾈﾚｰﾀﾃｰﾌﾞﾙの定義命令だと覚えておけば良いです。

　その次にｽﾌﾟﾗｲﾄｶﾗｰﾃｰﾌﾞﾙを定義します。
　　D$="":READ A$
    FOR J=0 TO 15:D$=D$+CHR$(VAL("&H"+MID$(A$,J*2+1,2))):NEXT
    COLORSPRITE$(0)=D$
　ここでもCOLORSPRITE$(ｽﾌﾟﾗｲﾄ面番号)文がｶﾗｰﾃｰﾌﾞﾙの定義命令だと覚えましょう。

　これで準備は終りました。あとは画面に表示させてみましょう。
　　PUTSPRITE 0,(150,100),,0

　はい、画面に表示されたはずです。実際にこれを利用して、解り易くしたサンプルゲーム(SAM-GAME.BAS)が入っていますので、そちらを参考にしてください。

（うんちく：もしあなたが各ﾃｰﾌﾞﾙがVRAMのどこに配置されているか知っていて、直
　　　　　　接書き込むことが出来るなら、VPOKE文を使ってｽﾌﾟﾗｲﾄを動かした方が、
　　　　　　PUTSPRITE文よりも早いですよ）


■参考文献
　もっと詳しくｽﾌﾟﾗｲﾄについて知りたい時は、(品薄ですが)下記の本を参考にすると良いでしょう。

　『MSXﾎﾟｹｯﾄﾊﾞﾝｸ ゲーム作りのテクニックｽﾌﾟﾗｲﾄ編』　ＢＩＴＳ著・アスキー
　『ＭＳＸ２ Technical Hand Book』　　　　　 　　　ｱｽｷｰ･ﾏｲｸﾛｿﾌﾄFE監修・アスキー
　『ＭＳＸ−Ｄａｔａｐａｃｋ』　　　　　　　　　　 ｱｽｷｰｼｽﾃﾑ事業部・アスキー　

